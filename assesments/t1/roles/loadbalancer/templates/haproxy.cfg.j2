global
    log /dev/log local0
    maxconn 4096
    daemon

defaults
    mode http
    timeout connect 5000ms
    timeout client 50000ms
    timeout server 50000ms

frontend http_front
    bind *:{{ haproxy_listen_port }}
    default_backend web_servers

backend web_servers
{% for backend in haproxy_backends %}
    server {{ backend.name }} {{ backend.host }}:{{ backend.port }} check
{% endfor %}

listen stats
    bind *:{{ haproxy_stats_port }}
    stats enable
    stats uri /stats
    stats refresh 10s
